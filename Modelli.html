<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Elementi di Econometria 2022/2023 - Giuseppe Ragusa - Sapienza">

<title>Econometria - Il modello lineare univariato</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href=".//files/icon-512.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/iconify-1.0.0-beta.2/iconify-icon.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Econometria</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Ricerca"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Attiva/disattiva la navigazione" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./programma.html" rel="" target="">
 <span class="menu-text">Programma del corso</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./materiale.html" rel="" target="">
 <span class="menu-text">Materiale didattico</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./risorse.qmd" rel="" target="">
 <span class="menu-text">Risorse</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Il modello lineare univariato</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Introduzione</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./../Lecture13.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1: Introduzione all’econometria <i class="fa-brands fa-slideshare" aria-label="slideshare"></i></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./../Lecture13b.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2: Richiami di probabilità e statistica <i class="fa-brands fa-slideshare" aria-label="slideshare"></i></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./../IntroduzioneR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3a: Introduzione ad R <iconify-icon inline="" icon="carbon:logo-r-script"></iconify-icon></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./../IntroduzioneR.Rmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3b: Introduzione ad R <i class="fa-solid fa-laptop-code" aria-label="laptop-code"></i></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Modello Lineare Univariato</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./../Lecture45.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4&amp;5: Formalizzazione e stima <i class="fa-brands fa-slideshare" aria-label="slideshare"></i></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Modello Lineare Multivariato</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./../Lecture67.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6&amp;7: Modello multivariato <i class="fa-brands fa-slideshare" aria-label="slideshare"></i></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./../Lecture8.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8: Inferenza <i class="fa-brands fa-slideshare" aria-label="slideshare"></i></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./../Lecture9.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9: Modelli non-lineari <i class="fa-brands fa-slideshare" aria-label="slideshare"></i></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Modelli per probabilià</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./../Lecture10.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10: LPM, Logit, Probit <i class="fa-brands fa-slideshare" aria-label="slideshare"></i></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">11: Panel data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./../panel.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Panel data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">12: Variabili strumentali</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./../iv.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IV</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">In questa pagina</h2>
   
  <ul>
  <li><a href="#ceteris-paribus" id="toc-ceteris-paribus" class="nav-link active" data-scroll-target="#ceteris-paribus">Ceteris paribus</a>
  <ul class="collapse">
  <li><a href="#il-modello-vero" id="toc-il-modello-vero" class="nav-link" data-scroll-target="#il-modello-vero">Il modello vero</a></li>
  <li><a href="#il-modello-lineare" id="toc-il-modello-lineare" class="nav-link" data-scroll-target="#il-modello-lineare">Il modello lineare</a></li>
  <li><a href="#lassunzione-chiave" id="toc-lassunzione-chiave" class="nav-link" data-scroll-target="#lassunzione-chiave">L’assunzione chiave</a>
  <ul class="collapse">
  <li><a href="#ols1" id="toc-ols1" class="nav-link" data-scroll-target="#ols1">OLS1</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Il modello lineare univariato</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="ceteris-paribus" class="level1">
<h1>Ceteris paribus</h1>
<p>“Ceteris paribus” è una locuzione latina che significa “a parità d’altre condizioni”, “date le medesime circostanze”. Viene spesso utilizzata in economia e in altri campi scientifici per descrivere la situazione in cui alcuni fattori di un sistema siano mantenuti costanti o invariati durante l’analisi dell’impatto di altri fattori su una variabile di interesse. L’effetto “ceteris paribus” di un aumento del prezzo di un bene porterà a una diminuzione della sua domanda” – questo effetto è calcolato assumendo che gli altri fattori che influenzano la domanda, come il reddito e le preferenze dei consumatori, rimangano invariate. L’obiettivo dell’econometria che studieremo è quello di utilizzare i dati per stimare effetti <em>ceteris paribus</em> di una variabile (o di più variabili) su unàaltra variabile.</p>
<p>Per comprendere le tecniche econometriche che introdurremo è essenziale definire con precisione il concetto di modello econometrico e la sua derivazione.</p>
<section id="il-modello-vero" class="level2">
<h2 class="anchored" data-anchor-id="il-modello-vero">Il modello vero</h2>
<p>Per poter provare a stimare l’effetto ceteris paribus di una variabile su un’altra occorre definire precisamente qual è in nostro obiettivo in termini matematici. Inizieremo postulando l’esistenza di un modello, il modello vero, che lega la variabile <span class="math inline">\(Y\)</span> ad altre variabili. <span id="eq-truth"><span class="math display">\[
Y = f^*(X_1, \ldots, X_k, W_1, \dots, W_r).
\tag{1}\]</span></span> <a href="#eq-truth">Equazione&nbsp;1</a> definisce il vero meccanismo di determinazione della variabile <span class="math inline">\(Y\)</span> sulla base delle <span class="math inline">\(k\)</span> variabili <span class="math inline">\(X_1,\dots,X_k\)</span> e delle <span class="math inline">\(r\)</span> variabili <span class="math inline">\(W_1,\dots,W_k\)</span>; <span class="math inline">\(f^*\)</span> è una funzione multivariata che descrive il meccanismo di determinazione. La ragione per cui stiamo usando una diversa notazione per le <span class="math inline">\(k\)</span> e le <span class="math inline">\(r\)</span> variabile è per sottolineare la loro diversa natura. Le variabili <span class="math inline">\(X_1,\dots,X_k\)</span> sono osservabili, cioè è possibile ottenere dati per queste variabili. Le variabili <span class="math inline">\(W_1,\dots,W_r\)</span> sono invece non-osservabili, cioè non è possibile raccogliere delle osservazioni.</p>
<p><a href="#eq-truth">Equazione&nbsp;1</a> potrebbe rappresentare il meccanismo con cui il salario di un individuo <span class="math inline">\(Y\)</span> viene determinato dal livello di istruzione (<span class="math inline">\(X_1\)</span>), dall’età <span class="math inline">\(X_2\)</span>, dal genere (<span class="math inline">\(X_3\)</span>), dall’esperienza (<span class="math inline">\(X_4\)</span>) e da altre variabili osservabili. A determinare il salario contribuisce anche l’abilità dell’individuo (<span class="math inline">\(W_1\)</span>). Abilità è una variabile che non osserviamo, cioè non esiste nessuna dataset che contiene questa informazioni ecco perché è relegata fra le <span class="math inline">\(W\)</span>.</p>
<p>E’ conveniente assumere una particolare struttura del modello. Assumeremo in particolare che il vero modello può essere scritto in questo modo: <span id="eq-truth2"><span class="math display">\[
Y = g^*(X_1, \ldots, X_k) + h^*(W_1, \dots, W_r).
\tag{2}\]</span></span> In <a href="#eq-truth2">Equazione&nbsp;2</a> il modello ha due componenti additive: <span class="math inline">\(g^*\)</span> è una funzione che ha come argomenti le sole variabili osservabili, mentre <span class="math inline">\(h^*\)</span> è una funzione delle sole variabili osservabili. L’effetto di un variazione di <span class="math inline">\(X_1\)</span> da <span class="math inline">\(x_1\)</span> a <span class="math inline">\(x_1'\)</span> tenendo costanti le altre variabili a <span class="math inline">\(X_2=x_2,\dots, X_k=x_k\)</span> e <span class="math inline">\(W_1=w_1,\dots, W_k=w_k\)</span> secondo il modello in <a href="#eq-truth2">Equazione&nbsp;2</a> è <span class="math display">\[
g^*(x', \ldots, x_k) - g^*(x, \ldots, x_k).
\]</span> Questo effetto in genere dipenderà da <span class="math inline">\(x\)</span> e <span class="math inline">\(x'\)</span>, ma anche da i valori a cui sono tenute tutte le variabili osservabili, mentre non dipende dai valori ai quali abbiamo tenuto costanti le variabili osservabili <span class="math inline">\(w_1, w_2, \dots, w_k\)</span>.</p>
<p>Supponiamo adesso che usando la teoria economica, il buon senso, l’intuizione ed un po’ di fortuna il modello che abbiamo in mente coincida per le variabili osservabili con quello dell’<strong>?@eq-eq-truth2</strong>. Il modello econometrico diventa <span class="math display">\[
Y = g^*(X_1, \ldots, X_k) + u
\]</span> dove <span class="math inline">\(u=h^*(W_1, \dots, W_r)\)</span> è la componente non osservata del modello.</p>
<p>Consideriamo un individuo con <span class="math inline">\((Y_i, X_{i1}, \dots, x_{ik})\)</span>. Secondo il modello econometrico <span class="math display">\[
Y_i = g^*(X_{i1}, \ldots, X_{ik}) + u_i
\]</span> dove <span class="math inline">\(u_i\)</span> è una variabile casuale perche il suo valore dipende dai valori non osservati per l’individuo <span class="math inline">\(i\)</span>.</p>
<p>Non ha senso chiederci qual è il valore di <span class="math inline">\(Y\)</span> associato con x’ e compagnia: non esiste un unico valore perché <span class="math inline">\(Y_i\)</span> prenderà gli stessi valore a seconda dei valori di <span class="math inline">\(W_1,\dots,W_r\)</span>, Questi valori sono casuali non non observabili e quindi non possiamo fissarli ad un valore. Quello che possiamo fare è chiederci e se <span class="math inline">\(E(Y_i\)</span></p>
<p>Se calcoliamo il valore di <span class="math inline">\(Y\)</span> corrispondente a <span class="math inline">\(X_1=x_1'\)</span>, e <span class="math inline">\(X_2=x_2\)</span>, <span class="math inline">\(X_k=x_k\)</span>.</p>
<p>Ma in questo modello non riusciremo a fissare i valori delle variabili non osservabili. Per esempio, il valore di <span class="math inline">\(Y\)</span> è</p>
<p>essendo osservabile è <span class="math inline">\(W_1\)</span>Potrebbe essere chiaramente determinato da Il livello di istruzione di un individuo è considerato un fattore chiave nella determinazione del suo reddito/salario. Tuttavia, ci sono anche altri fattori che possono influenzare il salario. Se indichiamo con <span class="math inline">\(Y\)</span> il salario, con <span class="math inline">\(X_1\)</span> il livello di istruzione (parleremo poi di cosa intendiamo per livello di istruzione) e con <span class="math inline">\(X_2\)</span>, <span class="math inline">\(X_3\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(X_k\)</span> gli altri fattori, possiamo pensare alla relazione come</p>
<p>In altre parole, avremo soltanto a disposizione dati su <span class="math inline">\(Y\)</span> e <span class="math inline">\(X\)</span>.</p>
<p>di cui vogliamo variabile <span class="math inline">\(Y\)</span> ad altre variabili</p>
<p>prrecisi definire adeguatamente i</p>
<p>Il livello di istruzione di un individuo è considerato un fattore chiave nella determinazione del suo reddito/salario. Tuttavia, ci sono anche altri fattori che possono influenzare il salario. Se indichiamo con <span class="math inline">\(Y\)</span> il salario, con <span class="math inline">\(X_1\)</span> il livello di istruzione (parleremo poi di cosa intendiamo per livello di istruzione) e con <span class="math inline">\(X_2\)</span>, <span class="math inline">\(X_3\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(X_k\)</span> gli altri fattori, possiamo pensare alla relazione come <span id="eq-mm"><span class="math display">\[
Y = f(X_1, X_2, X_3, X_4, X_5, X_6, X_7,\ldots,X_k).
\tag{3}\]</span></span> Per esempio, <span class="math inline">\(X_3\)</span> potrebbe rappresentare l’esperienza lavorativa dell’individuo, <span class="math inline">\(X_4\)</span> il genere (maschio/femmina) e <span class="math inline">\(X_5\)</span> l’età, <span class="math inline">\(X_6\)</span> la il settore dell’impiego, <span class="math inline">\(X_7\)</span> l’abilità dell’individuo e così via discorrendo. <a href="#eq-mm">Equazione&nbsp;3</a> definisce un <strong>modello</strong>, cioè una descrizione matematica di un meccanismo di determinazione della variabile <span class="math inline">\(Y\)</span>. La quasi totalità dei modelli economici può essere espressa in una maniera analoga all’<a href="#eq-mm">Equazione&nbsp;3</a>.</p>
<p>Come si fa a giungere al modello dell’<a href="#eq-mm">Equazione&nbsp;3</a>? Tipicamente ci si appella alla teoria economica. Per esempio, la teoria per la scelta del livello di istruzione, basata sulla massimizzazione dell’utilità nel corso della vita, postula che gli individui sceglieranno un livello di istruzione tale per cui il costo marginale di un’unità addizionale di istruzione è uguale al suo beneficio marginale. Costi e benefici marginali dipendono direttamente e indirettamente da una serie di fattori specifici all’individuo (le <span class="math inline">\(X\)</span> in <a href="#eq-mm">Equazione&nbsp;3</a>). La teoria non suggerisce direttamente la forma della funzione <span class="math inline">\(f\)</span> a meno che non si facciano delle assunzioni sulle funzioni di utilità e altre assunzioni sulle forme funzionali di altri elementi che compongono la teoria. Spesso i modelli vengono postulati senza fare riferimento alla teoria e sembrano originare dal buon senso e dall’intuizione economica. In realtà, anche quando non esplicito il ruolo della teoria è importante.</p>
<p>Per quanto sofisticata la teoria, le variabili <span class="math inline">\(X_1, \ldots, X_k\)</span> potrebbero non essere le sole a contribuire alla determinazione di <span class="math inline">\(Y\)</span>. In fin dei conti, Il ruolo di un modello è quello di stilizzare una realtà molto complessa, troppo complessa, rimuovendo i dettagli che sono poco importanti per la comprensione del meccanismo che ci interessa studiare. Il problema è che un’eccessiva o inopportuna semplificazione potrebbe rendere il modello poco utile per lo scopo per il quale è stato creato. Ci serve quindi un quadro di riferimento per comprendere se le semplificazioni adottate dal modello ci consentono comunque di ottenere relazioni ceteris paribus corrette. Chiaramente la definizione di modello corretto prevede la conoscenza dei veri effetti, ma se sapessimo i veri effetti modelli ed econometria non sarebbe necessari. Invece, partiamo da postulare il modello corretto: <span id="eq-mm2"><span class="math display">\[
  Y = h(X_1, \dots, X_k, W_1, \dots, W_r),
   \tag{4}\]</span></span> La differenza fra il vero modello e quello dell’<a href="#eq-mm">Equazione&nbsp;3</a> è la presenza della variabili <span class="math inline">\(W_1, W_2, \dots, W_r\)</span> e del fatto che la funzione che descrive le relazioni è <span class="math inline">\(h\)</span>. E’ importante sottolineare che il modello in <a href="#eq-mm2">Equazione&nbsp;5</a> non può essere effettivamente utilizzato; è semplicemente una pietra di paragone per capire quando il nostro modello in <a href="#eq-mm">Equazione&nbsp;3</a> può catturare le stesse relazioni <em>ceteris paribus</em> del modello in <a href="#eq-mm2">Equazione&nbsp;5</a>. Chiameremo le variabili <span class="math inline">\(W_1, W_2, \dots, W_r\)</span> non osservabili sia perchè non possono essere misurate (in questo caso )</p>
<p>Il modello economico potrebbe essere troppo generico e le variabili individuate sono un solo sottoinsieme di quelle che effettivamente contribuiscono alla determinazione di <span class="math inline">\(Y\)</span>. La nostra intuizione e il nostro buon senso essendo limitati ci portano a trascurate importanti variabili. Il <strong>vero</strong> modello per <span class="math inline">\(Y\)</span> è dunque <span id="eq-mm2"><span class="math display">\[
  Y = h(X_1, \dots, X_k, W_1, \dots, W_r),
   \tag{5}\]</span></span> dove <span class="math inline">\(W_1, W_2, \dots, W_r\)</span> sono le variabili che non abbiamo considerato in <a href="#eq-mm">Equazione&nbsp;3</a> e <span class="math inline">\(h\)</span> è una funzione che esplicita la loro relazione. E’ importante sottolineare che quest’ultimo modello non sarà quello utilizzato proprio perché non conosciamo cosa siano <span class="math inline">\(W_1, W_2, \dots, W_r\)</span>. Questo modello ci servirà esclusivamente come pietra di paragone per capire se il modello basato sulle variabili in <a href="#eq-mm">Equazione&nbsp;3</a> può catturare le stesse relazioni <em>ceteris paribus</em> del modello in <a href="#eq-mm2">Equazione&nbsp;5</a>. descrive il vero modello, allora <span class="math display">\[
  CPE(x,x')=\Delta_{f}(x,x')+\Delta_{\varepsilon}(x,x'),
  \]</span> dove <span class="math display">\[
  \begin{align*}
  \Delta_{f}(x,x') &amp; =E\left[f(X_{1},\dots,X_{k})|X_{1}=x'_{1},X_{2}=x_{2},\ldots,W_{1}=w_{1},\ldots,W_{r}=w_{r}\right]\\
&amp; \qquad-E\left[f(X_{1},\dots,X_{k},W_{1},W_{2},\dots,W_{r})|X_{1}=x_{1},X_{2}=x_{2},\ldots,W_{1}=w_{1},\ldots,W_{r}=w_{r}\right]
  \end{align*}
  \]</span> e <span class="math display">\[
  \Delta_{\varepsilon}(x,x')=E\left[\varepsilon|X_{1}=x'_{1},X_{2}=x_{2},\ldots,W_{1}=w_{1},\ldots,W_{r}=w_{r}\right]-E\left[\varepsilon|X_{1}=x{}_{1},X_{2}=x_{2},\ldots,W_{1}=w_{1},\ldots,W_{r}=w_{r}\right]
  \]</span> Andiamo a definire adesso l’effetto <em>ceteris paribus</em> di un variazione, da <span class="math inline">\(x_1\)</span> a <span class="math inline">\(x_1'\)</span> usando il modello in <a href="#eq-mm">Equazione&nbsp;3</a>. Questo è dato dalle seguente differenza nelle aspettative condizionali:</p>
<p><span class="math display">\[
  E\left[f(X_1,\dots,X_k)|X_1 = x'_1, X_2=x_2, \ldots, W_1=w_1,\ldots, W_r=w_r\right] - E\left[f(X_1, \dots, X_k, W_1, W_2, \dots, W_r)|X_1 = x_1, X_2=x_2, \ldots, W_1=w_1,\ldots, W_r=w_r\right].
  \]</span></p>
<p>è dato dalla della funzione <span class="math inline">\(h\)</span> quando una variabile, diciamo <span class="math inline">\(X_1\)</span>, mentre le altre rimangono costanti. Formalmente, <span class="math display">\[
  h(X_1+\Delta X_1, \dots, X_k, W_1, W_2, \dots, W_r) - h(X_1+\Delta X_1, \dots, X_k, W_1, W_2, \dots, W_r).
  \]</span> Come detto, quello che potremmo fare</p>
<p>### Ceteris Paribus effect L’effetto ceteris paribus di un aumento</p>
<p>Se il modello in <a href="#eq-mm">Equazione&nbsp;3</a> è postulato a partire dall’intuizione economica, in <span class="math inline">\(u\)</span> confluiscono altre variabili che non abbiamo erroneamente preso in considerazione. L’idea è che il vero meccanismo è <span class="math display">\[
  Y = h(X_1, \dots, X_k, W_1, W_2, \dots, W_r),
  \]</span> per una qualche funzione <span class="math inline">\(h\)</span>. Possiamo esprimere questo modello in termini del modello</p>
<p>La teoria economica può essere utilizzata come punto di partenza per specificare sia la forma funzionale di <span class="math inline">\(f\)</span> sia i fattori rilevanti per la determinazione del salario. Il modello teorico spesso utilizzato per studiare la relazione fra salari e livelli di educazione è quello in cui la scelta del livello di istruzione è dettata dalla massimizzazione dell’utilità nel corso della vita. Secondo questo modello gli individui sceglieranno un livello di istruzione tale per cui i costi marginali di una addizionale di istruzione sono uguali ai benefici marginali. Oltre a dipendere dal livello di istruzione questi costi e benefici dipendono dipendono direttamente e indirettamente da una serie di fattori specifici all’individuo (le <span class="math inline">\(X\)</span> in <a href="#eq-mm">Equazione&nbsp;3</a>). Alternativamente le variabili che influenzano il salario potrebbero essere dettate dal buon senso e non da una rigorosa analisi economica.</p>
<p>Quale che sia l’approccio per definire queste variabili, ricordiamoci che l’obiettivo non è fornirne un elenco. L’obiettivo è quello di quantificare mediante l’utilizzo di dati la relazione fra queste variabili e, in questo esempio, la relazione fra istruzione e salario. Chiaramente questo richiede di specificare una forma funzionale per <span class="math inline">\(f\)</span>, cioè fare delle assunzione affinché sia possibile poter determinare queste relazioni.</p>
<p>La specificazione della forma funzionale è una assunzione sia che derivi dalla teoria sia che provenga dalla nostra fantastica intuizione. Ma andiamo per ordine. Potremmo iniziare postulando che <span id="eq-me"><span class="math display">\[
Y = \beta_0 + \beta_1 X_{1} + \beta_2 X_{2} + \ldots + \beta_k X_{k} + u
\tag{6}\]</span></span> dove <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_k\)</span> sono i parametri del modello e <span class="math inline">\(u\)</span> e il termine di errore. Qual è la relazione fra <a href="#eq-mm">Equazione&nbsp;3</a> e quaste nuova specificazione? Sono due le differenze. La prima è che abbiamo imposto una forma funzionale particolare <em>scegliendo</em> per <span class="math inline">\(f\)</span> una forma lineare nelle variabili che comparivano in <a href="#eq-mm">Equazione&nbsp;3</a>. La seconda è che contiene il termine di errore <span class="math inline">\(u\)</span>. Comprendere la natura di <span class="math inline">\(u\)</span> è importantissimo e centrale per una corretta comprensione e interpretazione dei modelli econometrici.</p>
<p>Schematicamente, l’errore comprende le seguenti componenti:</p>
<ol type="1">
<li><em>altre variabili</em> che potrebbero contribuire a determinare <span class="math inline">\(Y\)</span> Le variabili <span class="math inline">\(X_1, \ldots, X_k\)</span> potrebbero non esaurire la lista di variabili che contribuiscono a determinare <span class="math inline">\(Y\)</span>. Questo perchè il modello economico è così generico che le variabili individuate sono sono un sottoinsieme di quelle che effettivamente contribuiscono alla determinazione di <span class="math inline">\(Y\)</span>. Se il modello in <a href="#eq-mm">Equazione&nbsp;3</a> è postulato a partire dall’intuizione economica, in <span class="math inline">\(u\)</span> confluiscono altre variabili che non abbiamo erroneamente preso in considerazione. L’idea è che il vero meccanismo è <span class="math display">\[
  Y = h(X_1, \dots, X_k, W_1, W_2, \dots, W_r),
  \]</span> per una qualche funzione <span class="math inline">\(h\)</span>. Possiamo esprimere questo modello in termini del modello</li>
<li>In questo caso, abbiamo che</li>
<li><em>errore di approssimazione</em>, cioè la differenza fra il modello lineare e il <em>vero</em> modello non lineare</li>
</ol>
<p>Queste assunzioni devono essere funzionali ai dati che abbiamo a disposizione. Supponiamo per il momento di avere a disposizioni un campione di individui (assumeremo sempre che il campione sia estratto casualmente dalla popolazione di riferimento) per i quali conosciamo soltanto il salario e il livello di istruzione. Cioè il nostro campione, di dimension <span class="math inline">\(n\)</span> è <span class="math inline">\({(Y_i, X_{1i}), (Y_1, X_{11}), \ldots, ((Y_n, X_{n1}))}\)</span>.</p>
<p>. Questo ha il vantaggio di rendere l’analisi più agile (spesso introdurre fattori coerentemente in un modello teorico è tecnicamente difficile), ma le derivazioni formali possono fornire una intuizione a cui il nostro buon senso non sarebbe mai giunto. Entrambi gli approcci sono seguiti in econometria. Quando i meccanismi e relazioni sono modellati sulla base della teoria economica parliamo di econometria strutturale. Quando invece le relazioni sono modellate sulla base dell’intuizione senza un preciso riferimento alla teoria economica parliamo di modelli a forma ridotta (reduced form). Quest’ultimo tipo di modelli è esplicitamente disegnato per l’analisi empirica e si basano su una descrizione più semplice e sintetica delle relazioni tra le variabili. Sebbene molti degli strumenti presentati di seguito sono tendenzialmente ispirati dai modelli a forma ridotta, molte delle tecniche possono essere impiegati nel campo dei modelli strutturali. Semplificando</p>
<p>Qualunque sia l’approccio che ha generato la specificazione in <a href="#eq-mm">Equazione&nbsp;3</a>,</p>
</section>
<section id="il-modello-lineare" class="level2">
<h2 class="anchored" data-anchor-id="il-modello-lineare">Il modello lineare</h2>
<p>Il modello di regressione lineare assume una relazione lineare tra la variabile indipendente <span class="math inline">\(X\)</span> e la variabile dipendente <span class="math inline">\(Y\)</span>, che può essere espressa come segue: <span id="eq-mdlu"><span class="math display">\[Y = \beta_0 + \beta_1 X + u, \tag{7}\]</span></span> dove <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> rappresentano parametri sconosciuti e <span class="math inline">\(u\)</span> è l’errore di regressione. L’errore <span class="math inline">\(u\)</span> incorpora tutti i fattori (o variabili) che influenzano <span class="math inline">\(Y\)</span> ma non sono inclusi nel modello lineare.</p>
<p>Prendiamo, ad esempio, il modello lineare che descrive la relazione tra i punteggi dei test (<span class="math inline">\(Y\)</span>) e la dimensione delle classi (<span class="math inline">\(X\)</span>). Ci sono numerosi fattori che influenzano i risultati dei test, tra cui la qualità degli insegnanti, la motivazione degli studenti, le competenze linguistiche degli alunni e le risorse della scuola. Questi fattori confluiscono nell’errore poiché non sono direttamente inclusi nel modello.</p>
<p>Un altro esempio di regressione lineare è la relazione tra il reddito di un individuo (<span class="math inline">\(Y\)</span>) e il livello di istruzione (<span class="math inline">\(X\)</span>). Anche in questo caso, ci sono molteplici fattori che influenzano il reddito di un individuo, come l’esperienza lavorativa, le abilità personali e il settore in cui si lavora. Questi fattori non inclusi nel modello lineare confluiscono nel termine di errore <span class="math inline">\(u\)</span>.</p>
<p>Quando riferite al modello in <a href="#eq-mdlu">Equazione&nbsp;7</a>, le variabili <span class="math inline">\(Y\)</span> e <span class="math inline">\(X\)</span> prendono diversi nomi spesso utilizzati in modo intercambiabile. <span class="math inline">\(Y\)</span> viene chiamata variabile dipendente, variabile da spiegare o variabile. La variabile <span class="math inline">\(X\)</span> viene chiamata variabile indipendente, variabile esplicativa, variabile di controllo, variabile predittiva o regressore. Più infrequentemente ci si riferisce a <span class="math inline">\(X\)</span> con il termine covariata. I termini “variabile dipendente” e “variabile indipendente” sono frequentemente utilizzati in econometria. Tuttavia, si noti che “indipendente” non si riferisce in questo caso alla nozione statistica di indipendenza tra variabili casuali.</p>
<p>La scelta di utilizzare un modello lineare è ovviamente una semplificazione. Linearità implica che una variazione di una unità di <span class="math inline">\(X\)</span> abbia lo stesso effetto su <span class="math inline">\(Y\)</span>, indipendentemente dal valore iniziale di <span class="math inline">\(X\)</span>. Questo è irrealistico per molte applicazioni economiche. Ad esempio, nell’esempio del salario-educazione, potremmo voler consentire dei rendimenti crescenti: un anno addizionale di istruzione potrebbe infatti avere un effetto maggiore sul salario se quell’anno è speso in un master piuttosto che uno scuola media.</p>
<p>Sono diverse le ragione per questa semplificazione. Prima di tutto, i modelli lineari sono matematicamente semplici e facili da interpretare, il che rende l’analisi più accessibile anche per chi non ha un background matematico avanzato. Il modello lineare consente di valutare la relazione tra le variabili sotto assunzioni trasparenti e permette anche di predire <span class="math inline">\(Y\)</span> sulla base del valore di <span class="math inline">\(X\)</span> molto semplicemente. Vedremo più avanti che sebbene la linearità sia un limite, il modello può essere modificato al fine di tenere in considerazione la presenza di relazioni non-lineari.</p>
</section>
<section id="lassunzione-chiave" class="level2">
<h2 class="anchored" data-anchor-id="lassunzione-chiave">L’assunzione chiave</h2>
<p>La assunzione chiave del modello lineare è la seguente:</p>
<div id="ass-key">
<section id="ols1" class="level3">
<h3 class="anchored" data-anchor-id="ols1">OLS1</h3>
<p><span class="math inline">\(E(u|X) = 0\)</span></p>
</section>
</div>
<p>Si ricordi che se <span class="math inline">\(E(u|X) = 0\)</span>, allora <span class="math inline">\(corr(u,X)=0\)</span>. Quindi, questa assunzione stipula che la variabile inclusa del modello, <span class="math inline">\(X\)</span>, e altre variabili che hanno una qualche relazione con <span class="math inline">\(Y\)</span> e contenute in <span class="math inline">\(u\)</span> non sono correlate.</p>
<p>Questa è un’assunzione molto forte e, come vedremo, in molte applicazioni non potrà essere considerata valida. In ogni caso, inizieremo a studiare il modello lineare sotto questa assunzione per comprendere la sua logica. In seguito, ci chiederemo come sia possibile interpretare il modello quando l’assunzione non è soddisfatta.</p>
<p>La fondamentale implicazione di <span class="citation" data-cites="ass-key">(<a href="#ref-ass-key" role="doc-biblioref"><strong>ass-key?</strong></a>)</span> è che l’aspettativa condizionale di <span class="math inline">\(Y\)</span> dato <span class="math inline">\(X\)</span> è lineare in <span class="math inline">\(X\)</span>, cioè <span class="math display">\[
E(Y|X) = \beta_0 + \beta_1 X.
\]</span> Usando questa linearità possiamo ottenere l’interpretazione del parametro <span class="math inline">\(\beta_1\)</span>: <span class="math display">\[
E(Y|X=x+1) - E(Y|X=x) = \left[\beta_0 + \beta_1 (x+1)\right]  - \left[\beta_0 + \beta_1 x\right] = \beta_1,
\]</span> <span class="math inline">\(\beta_1\)</span> ci dà la risposta di <span class="math inline">\(E(Y|X)\)</span> ad una variazione unitaria (da <span class="math inline">\(x\)</span> a <span class="math inline">\(x+1\)</span>) di <span class="math inline">\(X\)</span>.</p>
<p>::: {.boxmore} Anche <span class="math inline">\(\beta_0\)</span> ha una interpretazione in termini del valore atteso condizionato di <span class="math inline">\(Y\)</span>: <span id="eq-intercetta"><span class="math display">\[\beta_0 = E(Y|X=0). \tag{8}\]</span></span> Sebbene formalmente corretta, l’interpretazione pratica dell’intercetta è resa problematica da due fatti: <em>(i)</em> in molte applicazione, la variabile <span class="math inline">\(X\)</span> non assume il valore <span class="math inline">\(0\)</span>. Se il modello lineare della dimensione delle aule e potrebbe non assumere il valore <span class="math inline">\(\beta_0\)</span> <em>assorbe</em> la media delle variabile omesse. Cosa succede se invece che uguale a zero, l’aspettativa di <span class="math inline">\(u\)</span> dato <span class="math inline">\(X\)</span> è uguale ad una costante, per esempio <span class="math inline">\(E(u|X)=5\)</span>, o <span class="math inline">\(E(u|X)=15\)</span>. In questo caso è normale pensare che <span class="citation" data-cites="ass-key">(<a href="#ref-ass-key" role="doc-biblioref"><strong>ass-key?</strong></a>)</span> non sia valida e l’interpretazione di <span class="math inline">\(\beta_1\)</span> non sarà quella di quantificare l’effetto di una variazione unitaria sul valore atteso condizionato di <span class="math inline">\(Y\)</span>. In realtà le cose sono un tantino più complicate. Proviamo a capire perché. Se <span class="math inline">\(E(u|X)=\kappa_u\)</span> per qualche valore <span class="math inline">\(\kappa_u\)</span>, abbiamo che <span class="math display">\[
E(Y|X) = E(\beta_0 + \beta_1 X + \kappa_u|X) = \beta_0 + \beta_1 X + \kappa_u.
\]</span> L’aspettativa condizionata è ancora lineare, ma con un intercetta uguale a <span class="math inline">\(\beta_0 + \kappa_u\)</span>. In ogni caso, l’interpretazione di <span class="math inline">\(\beta_1\)</span> è invariata rispetta al caso in cui <span class="math inline">\(\kappa_u=0\)</span> (cioè nel caso specificato dall’{#ass-key}), come si vede chiaramente da <span class="math display">\[
E(Y|X=x+1) - E(Y|X=x) = \left[\beta_0 + \beta_1 (x+1) + \kappa_u\right]  - \left[\beta_0 + \beta_1 x + \kappa_u\right] = \beta_1.
\]</span> A questo punto è lecito essere confusi. Abbiamo parlato più volte della centralità dell’assunzione <span class="math inline">\(E(u|X)=0\)</span>, ma adesso sembrerebbe che l’interpretazione di <span class="math inline">\(\beta_1\)</span> è sempre <span class="math inline">\(E(Y|X=x+1) - E(Y|X=x)\)</span> anche quando <span class="math inline">\(E(u|X)=\kappa_u \neq 0\)</span>. Ora consideriamo il modello lineare data da <span class="math display">\[
Y = \beta_0 + \beta_1 X_i + \varepsilon_i,
\]</span> dove <span class="math inline">\(\varepsilon_i=u_i-\kappa_u\)</span>. In questo modello l’errore è uguale all’errore originale, <span class="math inline">\(u_i\)</span>, a cui abbiamo sottratto <span class="math inline">\(\kappa_u\)</span>. Questo è un nuovo modello lineare che soddisfa <span class="citation" data-cites="ass-key">(<a href="#ref-ass-key" role="doc-biblioref"><strong>ass-key?</strong></a>)</span> — <span class="math inline">\(E(\varepsilon_i|X)=E(u_i|X)-\kappa_u=\kappa_u - \kappa_u = 0\)</span> — e dove <span class="math inline">\(\beta_1=E(Y|X=x+1) - E(Y|X=x)\)</span>$ è</p>
<p>In realtà, l’assunzione necessaria per interpretare <span class="math inline">\(\beta_1\)</span> come la variazione di <span class="math inline">\(E(Y|X)\)</span> dovuta ad una variazione di <span class="math inline">\(X\)</span> è <span class="math display">\[
E(u|X) = \text{constant}.
\]</span> Sembrerebbe che L’assunzione è falsa non quando <span class="math inline">\(E(u|X)\neq 0\)</span>, ma quando il valore atteso di <span class="math inline">\(u\)</span> dato <span class="math inline">\(X\)</span> varia con <span class="math inline">\(X\)</span>. In altre parole, l’assunzione #ass-key non è soddisfatta se <span class="math display">\[
E(u|X=x) = f(x),
\]</span> dove <span class="math inline">\(f(\cdot)\)</span> è una funzione non constante, cioè una funzione tale per cui <span class="math inline">\(f(x_1)\neq f(x_2)\)</span> per almeno una coppia di valori <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiato!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiato!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>